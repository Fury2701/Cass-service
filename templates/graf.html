<!DOCTYPE html>
<html>
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="static/css/adm-panel.css">
        <title>Admin</title>
    </head>
    <body>
        <nav class="navbar navbar-expand-lg navbar-light bg-light gradientfin-bg">
            <div class="container-fluid" id="navtext" style = "margin-left: 37%;">
                <a class="navbar-brand fontweight fw-bold" href="/adm-panel" style="color: #fff;">Фінанси</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link active fontweight fw-bold" aria-current="page" href="/graf" style="color: #fff;">Графіки</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link fontweight fw-bold" href="/users" style="color: #fff;">Користувачі</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link fontweight fw-bold" href="/allinfo" style="color: #fff;">Історія</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link fontweight fw-bold" href="/logout-admin" style="color: #fff;">Вихід</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="buttons">
            <input type="text" id="select-date1" placeholder="З дати">
            <input type="text" id="select-date2"placeholder="До дати">
            <button id="get-data">Отримати дані</button>
        </div>
        <div class="sel">
            <label for="info">Номер каси:</label>
            <select class="cass" name="cass" id="cass">
                <option value="all">Всі</option>
                {% for cass_id in cass %}
                    <option value="{{ cass_id }}">{{ cass_id }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="container mt-5" style="max-width: 80%;">
            <div class="row justify-content-center">
                <div class="col-md-6 text-center">     
                        <canvas id="myChart" width="400" height="400"></canvas>
                </div>
                <div class="col-md-6 text-center">
                    <canvas id="operationsChart" width="400" height="400"></canvas>
                </div>
            </div>
        </div>  
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <link rel="stylesheet" type="text/css" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
        <script src="{{ url_for('static', filename='adm.js') }}"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                var ctx = document.getElementById('myChart').getContext('2d');
                var dailyProfitData = JSON.parse('{{ daily_profit | tojson | safe }}');
                var dates = dailyProfitData.map(function(item) {
                    return item[0];
                });
                var profits = dailyProfitData.map(function(item) {
                    return item[1];
                });
                var numOperations = dailyProfitData.map(function(item) {
                    return item[2];
                });
        
                window.myChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: dates,
                        datasets: [{
                            label: 'Прибуток за день',
                            data: profits,
                            fill: false,
                            borderColor: 'rgb(75, 192, 192)',
                            tension: 0.1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            });
        </script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                var ctx = document.getElementById('operationsChart').getContext('2d');
                var dailyOperationsData = JSON.parse('{{ daily_operations | tojson | safe }}');
                var dates = Object.keys(dailyOperationsData);
                var numOperations = Object.values(dailyOperationsData);
        
                window.operationsChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: dates,
                        datasets: [{
                            label: 'Кількість операцій за день',
                            data: numOperations,
                            fill: false,
                            borderColor: 'rgb(255, 99, 132)',
                            tension: 0.1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            });
        </script>        
    </body>
</html>
